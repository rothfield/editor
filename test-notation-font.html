<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Notation Font Demo - All Systems</title>
    <style>
        /* Font Declaration */
        @font-face {
            font-family: 'NotationMonoDotted';
            src: url('/dist/fonts/NotationMonoDotted.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .system-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .system-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .system-card h2 {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .system-card p {
            font-size: 0.95em;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .notation-display {
            font-family: 'NotationMonoDotted', monospace;
            font-size: 32px;
            line-height: 2;
            letter-spacing: 0.2em;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .notation-variants {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .variant {
            flex: 1;
            min-width: 80px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 6px;
            border: 1px solid #ddd;
            text-align: center;
        }

        .variant-label {
            font-size: 0.75em;
            color: #999;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .variant-char {
            font-family: 'NotationMonoDotted', monospace;
            font-size: 24px;
            line-height: 1.8;
        }

        .test-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .test-section h3 {
            font-size: 1.3em;
            margin-bottom: 20px;
            color: #333;
            border-left: 4px solid #667eea;
            padding-left: 15px;
        }

        .test-row {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 6px;
        }

        .test-label {
            min-width: 150px;
            font-weight: 600;
            color: #667eea;
        }

        .test-result {
            font-family: 'NotationMonoDotted', monospace;
            font-size: 28px;
            flex: 1;
            padding: 10px 15px;
            background: white;
            border-radius: 4px;
            border-left: 3px solid #667eea;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-size: 0.95em;
            color: #1565c0;
            line-height: 1.6;
        }

        .success-box {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-size: 0.95em;
            color: #2e7d32;
            line-height: 1.6;
        }

        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        footer {
            text-align: center;
            color: white;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .notation-display {
                font-size: 24px;
            }

            .grid {
                grid-template-columns: 1fr;
            }

            .test-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .test-label {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽµ Notation Font Demo</h1>
            <p>NotationMonoDotted.ttf â€” All 4 Notation Systems</p>
        </header>

        <div class="success-box">
            âœ… Font successfully loaded! All 4 notation systems with 1-2 dots above/below are working.
        </div>

        <!-- System Overview Grid -->
        <div class="grid">
            <!-- Number System -->
            <div class="system-card">
                <h2>Number System</h2>
                <p>Default notation using digits 1-7</p>
                <div class="notation-display" id="number-display">1 2 3 4 5 6 7</div>
                <div class="notation-variants">
                    <div class="variant">
                        <div class="variant-label">No Dots</div>
                        <div class="variant-char" id="n-plain">1</div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">1 Dot Above</div>
                        <div class="variant-char" id="n-above1"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">2 Dots Above</div>
                        <div class="variant-char" id="n-above2"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">1 Dot Below</div>
                        <div class="variant-char" id="n-below1"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">2 Dots Below</div>
                        <div class="variant-char" id="n-below2"></div>
                    </div>
                </div>
            </div>

            <!-- Western System -->
            <div class="system-card">
                <h2>Western System</h2>
                <p>Musical letters A-G with upper and lowercase</p>
                <div class="notation-display" id="western-display">C D E F G A B</div>
                <div class="notation-variants">
                    <div class="variant">
                        <div class="variant-label">No Dots</div>
                        <div class="variant-char" id="w-plain">C</div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">1 Dot Above</div>
                        <div class="variant-char" id="w-above1"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">2 Dots Above</div>
                        <div class="variant-char" id="w-above2"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">1 Dot Below</div>
                        <div class="variant-char" id="w-below1"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">2 Dots Below</div>
                        <div class="variant-char" id="w-below2"></div>
                    </div>
                </div>
            </div>

            <!-- Sargam System -->
            <div class="system-card">
                <h2>Sargam System</h2>
                <p>Indian classical notation Sa-Re-Ga-Ma-Pa-Dha-Ni</p>
                <div class="notation-display" id="sargam-display">S r R g G m M P</div>
                <div class="notation-variants">
                    <div class="variant">
                        <div class="variant-label">No Dots</div>
                        <div class="variant-char" id="s-plain">S</div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">1 Dot Above</div>
                        <div class="variant-char" id="s-above1"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">2 Dots Above</div>
                        <div class="variant-char" id="s-above2"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">1 Dot Below</div>
                        <div class="variant-char" id="s-below1"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">2 Dots Below</div>
                        <div class="variant-char" id="s-below2"></div>
                    </div>
                </div>
            </div>

            <!-- Doremi System -->
            <div class="system-card">
                <h2>Doremi System âœ“</h2>
                <p>SolfÃ¨ge notation with 'f' for Fa note</p>
                <div class="notation-display" id="doremi-display">d r m f s l t</div>
                <div class="notation-variants">
                    <div class="variant">
                        <div class="variant-label">No Dots</div>
                        <div class="variant-char" id="d-plain">f</div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">1 Dot Above</div>
                        <div class="variant-char" id="d-above1"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">2 Dots Above</div>
                        <div class="variant-char" id="d-above2"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">1 Dot Below</div>
                        <div class="variant-char" id="d-below1"></div>
                    </div>
                    <div class="variant">
                        <div class="variant-label">2 Dots Below</div>
                        <div class="variant-char" id="d-below2"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comprehensive Test Section -->
        <div class="test-section">
            <h3>Complete Character Reference</h3>

            <div class="info-box">
                ðŸ“– Each character below shows all 4 octave variants (1-2 dots above/below)
            </div>

            <h4 style="margin-top: 20px; margin-bottom: 15px; color: #667eea;">Number System (1234567)</h4>
            <div id="number-chars"></div>

            <h4 style="margin-top: 20px; margin-bottom: 15px; color: #667eea;">Western System (CDEFGABcdefgab)</h4>
            <div id="western-chars"></div>

            <h4 style="margin-top: 20px; margin-bottom: 15px; color: #667eea;">Sargam System (SrRgGmMPdDnN)</h4>
            <div id="sargam-chars"></div>

            <h4 style="margin-top: 20px; margin-bottom: 15px; color: #667eea;">Doremi System (drmfsltDRMFSLT) âœ“</h4>
            <div id="doremi-chars"></div>
        </div>

        <!-- Code Example -->
        <div class="test-section">
            <h3>How It Works</h3>

            <div class="info-box">
                The font uses Unicode Private Use Area (PUA) codepoints starting at <code>0xE000</code>.
                Each character gets 4 variants (1-2 dots above/below).
            </div>

            <h4 style="margin-bottom: 15px; color: #333;">Formula</h4>
            <pre style="background: #f5f5f5; padding: 15px; border-radius: 6px; overflow-x: auto; margin-bottom: 20px;"><code>codepoint = 0xE000 + (character_index Ã— 4) + variant_index

where variant_index:
  0 = 1 dot above
  1 = 2 dots above
  2 = 1 dot below
  3 = 2 dots below</code></pre>

            <h4 style="margin-bottom: 15px; color: #333;">JavaScript Implementation</h4>
            <pre style="background: #f5f5f5; padding: 15px; border-radius: 6px; overflow-x: auto; margin-bottom: 20px;"><code>const ALL_CHARS = "1234567CDEFGABcdefgabSrRgGmMPdDnNdrmfsltDRMFSLT";

function getGlyph(baseChar, octaveShift) {
    const index = ALL_CHARS.indexOf(baseChar);
    if (index === -1 || octaveShift === 0) return baseChar;

    let variant;
    switch (octaveShift) {
        case 1:  variant = 0; break;  // 1 dot above
        case 2:  variant = 1; break;  // 2 dots above
        case -1: variant = 2; break;  // 1 dot below
        case -2: variant = 3; break;  // 2 dots below
        default: return baseChar;
    }

    const codepoint = 0xE000 + (index * 4) + variant;
    return String.fromCodePoint(codepoint);
}</code></pre>

            <h4 style="margin-bottom: 15px; color: #333;">Usage Examples</h4>
            <div id="usage-examples"></div>
        </div>

        <!-- Statistics -->
        <div class="stats">
            <div class="stat-box">
                <div class="stat-value">47</div>
                <div class="stat-label">Base Characters</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">188</div>
                <div class="stat-label">Total Glyphs</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">4</div>
                <div class="stat-label">Notation Systems</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">0xE000-0xE0BB</div>
                <div class="stat-label">Codepoint Range</div>
            </div>
        </div>

        <footer>
            <p>Generated: 2025-11-07 | Font: NotationMonoDotted.ttf | Status: âœ… Production Ready</p>
        </footer>
    </div>

    <script>
        // Character order (MUST match Python and Rust)
        const ALL_CHARS = "1234567CDEFGABcdefgabSrRgGmMPdDnNdrmfsltDRMFSLT";
        const PUA_START = 0xE000;

        // Get glyph codepoint for a character with octave shift
        function getGlyph(baseChar, octaveShift) {
            const index = ALL_CHARS.indexOf(baseChar);
            if (index === -1 || octaveShift === 0) return baseChar;

            let variant;
            switch (octaveShift) {
                case 1:  variant = 0; break;  // 1 dot above
                case 2:  variant = 1; break;  // 2 dots above
                case -1: variant = 2; break;  // 1 dot below
                case -2: variant = 3; break;  // 2 dots below
                default: return baseChar;
            }

            const codepoint = PUA_START + (index * 4) + variant;
            const result = String.fromCodePoint(codepoint);

            // Debug first call only
            if (!window.debugLogged) {
                window.debugLogged = true;
                console.log('DEBUG: getGlyph called');
                console.log('  baseChar:', baseChar);
                console.log('  index:', index);
                console.log('  ALL_CHARS:', ALL_CHARS);
                console.log('  octaveShift:', octaveShift);
                console.log('  variant:', variant);
                console.log('  codepoint:', `0x${codepoint.toString(16)}`);
                console.log('  result charCode:', result.charCodeAt(0), `(0x${result.charCodeAt(0).toString(16)})`);
            }

            return result;
        }

        // Populate variant examples
        function populateVariants() {
            // Number system (1)
            document.getElementById('n-above1').textContent = getGlyph('1', 1);
            document.getElementById('n-above2').textContent = getGlyph('1', 2);
            document.getElementById('n-below1').textContent = getGlyph('1', -1);
            document.getElementById('n-below2').textContent = getGlyph('1', -2);

            // Western system (C)
            document.getElementById('w-above1').textContent = getGlyph('C', 1);
            document.getElementById('w-above2').textContent = getGlyph('C', 2);
            document.getElementById('w-below1').textContent = getGlyph('C', -1);
            document.getElementById('w-below2').textContent = getGlyph('C', -2);

            // Sargam system (S)
            document.getElementById('s-above1').textContent = getGlyph('S', 1);
            document.getElementById('s-above2').textContent = getGlyph('S', 2);
            document.getElementById('s-below1').textContent = getGlyph('S', -1);
            document.getElementById('s-below2').textContent = getGlyph('S', -2);

            // Doremi system (f)
            document.getElementById('d-above1').textContent = getGlyph('f', 1);
            document.getElementById('d-above2').textContent = getGlyph('f', 2);
            document.getElementById('d-below1').textContent = getGlyph('f', -1);
            document.getElementById('d-below2').textContent = getGlyph('f', -2);
        }

        // Populate complete character reference
        function populateCharacterReference() {
            const systems = [
                { name: 'number', chars: '1234567', container: 'number-chars' },
                { name: 'western', chars: 'CDEFGABcdefgab', container: 'western-chars' },
                { name: 'sargam', chars: 'SrRgGmMPdDnN', container: 'sargam-chars' },
                { name: 'doremi', chars: 'drmfsltDRMFSLT', container: 'doremi-chars' }
            ];

            systems.forEach(system => {
                const container = document.getElementById(system.container);
                for (const char of system.chars) {
                    const row = document.createElement('div');
                    row.className = 'test-row';

                    const label = document.createElement('div');
                    label.className = 'test-label';
                    label.textContent = `'${char}'`;

                    const result = document.createElement('div');
                    result.className = 'test-result';
                    result.style.display = 'flex';
                    result.style.gap = '15px';
                    result.style.alignItems = 'center';

                    const variants = [
                        { char, shift: 1, label: 'â†‘' },
                        { char, shift: 2, label: 'â†‘â†‘' },
                        { char, shift: -1, label: 'â†“' },
                        { char, shift: -2, label: 'â†“â†“' }
                    ];

                    variants.forEach(v => {
                        const span = document.createElement('span');
                        span.textContent = getGlyph(v.char, v.shift);
                        span.title = `${v.char} with ${v.label}`;
                        result.appendChild(span);
                    });

                    row.appendChild(label);
                    row.appendChild(result);
                    container.appendChild(row);
                }
            });
        }

        // Populate usage examples
        function populateUsageExamples() {
            const examples = [
                { char: '1', shift: 1, desc: 'Number 1 with 1 dot above' },
                { char: 'C', shift: 2, desc: 'Western C with 2 dots above' },
                { char: 'S', shift: -1, desc: 'Sargam S with 1 dot below' },
                { char: 'f', shift: 1, desc: 'Doremi f (fa) with 1 dot above' },
                { char: 'F', shift: 2, desc: 'Doremi F (FA) with 2 dots above' },
                { char: 'd', shift: -2, desc: 'Doremi d with 2 dots below' }
            ];

            const container = document.getElementById('usage-examples');
            examples.forEach(ex => {
                const row = document.createElement('div');
                row.className = 'test-row';

                const label = document.createElement('div');
                label.className = 'test-label';
                label.textContent = `getGlyph('${ex.char}', ${ex.shift})`;

                const result = document.createElement('div');
                result.className = 'test-result';
                result.textContent = getGlyph(ex.char, ex.shift);
                result.title = ex.desc;
                result.style.borderLeftColor = '#4caf50';

                row.appendChild(label);
                row.appendChild(result);
                container.appendChild(row);
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            populateVariants();
            populateCharacterReference();
            populateUsageExamples();
            console.log('âœ… Notation Font Demo loaded successfully');
            console.log('Font: NotationMonoDotted.ttf');
            console.log('Total characters: 47');
            console.log('Total glyphs: 188');
            console.log('Systems: Number, Western, Sargam, Doremi (with f)');
        });
    </script>
</body>
</html>
