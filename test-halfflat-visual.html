<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Half-Flat Visual Test</title>
    <style>
        @font-face {
            font-family: 'NotationFont';
            src: url('dist/fonts/NotationFont-Number.ttf') format('truetype');
        }

        body {
            font-family: Arial, sans-serif;
            padding: 40px;
            background: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            margin-bottom: 30px;
            color: #333;
        }

        .test-section {
            margin: 40px 0;
            padding: 20px;
            background: #fafafa;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .glyph-display {
            font-family: 'NotationFont', monospace;
            font-size: 120px;
            text-align: center;
            padding: 40px;
            background: white;
            border: 2px solid #e0e0e0;
            margin: 20px 0;
        }

        .comparison {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
        }

        .comparison-item {
            text-align: center;
            flex: 1;
            padding: 20px;
        }

        .label {
            font-size: 14px;
            color: #666;
            margin-top: 10px;
        }

        .size-test {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .size-item {
            padding: 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Half-Flat Accidental Visual Test</h1>

        <div class="test-section">
            <h2>Half-Flat Glyph (Large)</h2>
            <div class="glyph-display" id="halfflat-large">
                <!-- Will be populated by JavaScript -->
            </div>
            <div class="label">Unicode: <code id="halfflat-code"></code></div>
        </div>

        <div class="test-section">
            <h2>Comparison: Natural vs Flat vs Half-Flat</h2>
            <div class="comparison">
                <div class="comparison-item">
                    <div class="glyph-display" style="font-size: 80px;" id="natural">1</div>
                    <div class="label">Natural (base)</div>
                </div>
                <div class="comparison-item">
                    <div class="glyph-display" style="font-size: 80px;" id="flat">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <div class="label">Flat</div>
                </div>
                <div class="comparison-item">
                    <div class="glyph-display" style="font-size: 80px;" id="halfflat">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <div class="label">Half-Flat (new slash)</div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>Different Sizes</h2>
            <div class="size-test">
                <div class="size-item">
                    <div style="font-family: NotationFont; font-size: 32px;" id="size-32"></div>
                    <div class="label">32px</div>
                </div>
                <div class="size-item">
                    <div style="font-family: NotationFont; font-size: 48px;" id="size-48"></div>
                    <div class="label">48px</div>
                </div>
                <div class="size-item">
                    <div style="font-family: NotationFont; font-size: 64px;" id="size-64"></div>
                    <div class="label">64px</div>
                </div>
                <div class="size-item">
                    <div style="font-family: NotationFont; font-size: 96px;" id="size-96"></div>
                    <div class="label">96px</div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>All Number System Half-Flats</h2>
            <div style="font-family: NotationFont; font-size: 64px; text-align: center; line-height: 1.8;" id="all-halfflats">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Number system PUA base: 0xE000
        // Variant formula: pua_base + (char_idx × 30) + variant_index
        // Half-flat variants: acc_type=2, so variant_index = (2 × 5) + octave_idx
        // For base octave (octave_idx=0): variant_index = 10

        const numberSystemBase = 0xE000;
        const halfFlatVariantOffset = 10; // acc_type=2 (half-flat), octave_idx=0 (base)

        // Generate half-flat codepoints for Number system (1-7)
        const halfFlats = [];
        for (let charIdx = 0; charIdx < 7; charIdx++) {
            const codepoint = numberSystemBase + (charIdx * 30) + halfFlatVariantOffset;
            halfFlats.push(codepoint);
        }

        // Display large half-flat (for "1" which is char_idx=0)
        const halfflat1Codepoint = halfFlats[0];
        document.getElementById('halfflat-large').textContent = String.fromCodePoint(halfflat1Codepoint);
        document.getElementById('halfflat-code').textContent = `U+${halfflat1Codepoint.toString(16).toUpperCase()}`;

        // Comparison: Flat (acc_type=1)
        const flatVariantOffset = 5; // acc_type=1, octave_idx=0
        const flat1Codepoint = numberSystemBase + (0 * 30) + flatVariantOffset;
        document.getElementById('flat').textContent = String.fromCodePoint(flat1Codepoint);
        document.getElementById('halfflat').textContent = String.fromCodePoint(halfflat1Codepoint);

        // Different sizes
        document.getElementById('size-32').textContent = String.fromCodePoint(halfflat1Codepoint);
        document.getElementById('size-48').textContent = String.fromCodePoint(halfflat1Codepoint);
        document.getElementById('size-64').textContent = String.fromCodePoint(halfflat1Codepoint);
        document.getElementById('size-96').textContent = String.fromCodePoint(halfflat1Codepoint);

        // All half-flats (1-7)
        const allHalfFlatsText = halfFlats.map(cp => String.fromCodePoint(cp)).join('  ');
        document.getElementById('all-halfflats').textContent = allHalfFlatsText;
    </script>
</body>
</html>
